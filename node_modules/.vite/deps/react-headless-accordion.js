import {
  require_react
} from "./chunk-LXGCQ6UQ.js";
import {
  __toESM
} from "./chunk-ROME4SDB.js";

// node_modules/react-headless-accordion/dist/index.esm.js
var import_react = __toESM(require_react());
var AccordionContext = (0, import_react.createContext)({
  accordionRef: null,
  items: {},
  setItems: (data) => {
  },
  transition: null,
  alwaysOpen: false
});
var Accordion = ({ children, as = "div", className = "", transition = void 0, alwaysOpen = false }) => {
  const accordionRef = (0, import_react.useRef)(null);
  const [items, setItems] = (0, import_react.useState)({});
  const TagName = (0, import_react.useMemo)(() => {
    if (as) {
      return as;
    }
    return "div";
  }, [as]);
  const value = (0, import_react.useMemo)(() => {
    return {
      accordionRef,
      items,
      setItems,
      transition,
      alwaysOpen
    };
  }, [alwaysOpen, items, transition]);
  return import_react.default.createElement(
    AccordionContext.Provider,
    { value },
    import_react.default.createElement(TagName, { className }, children)
  );
};
var AccordionItemContext = (0, import_react.createContext)({
  accordionRef: null,
  active: false,
  items: {},
  hash: "",
  transition: null,
  alwaysOpen: false,
  toggle: () => {
  },
  isActive: false
});
var AccordionItem = ({ children, isActive = false }) => {
  const { accordionRef, items, setItems, transition, alwaysOpen } = (0, import_react.useContext)(AccordionContext);
  const [active, setActive] = (0, import_react.useState)(false);
  const hash = (0, import_react.useMemo)(() => {
    return Math.random().toString(36).substring(2, 9);
  }, []);
  (0, import_react.useEffect)(() => {
    if (!(hash in items)) {
      setItems({ ...items, [hash]: setActive });
    }
  }, [items]);
  const value = (0, import_react.useMemo)(() => {
    return {
      accordionRef,
      active,
      toggle: () => setActive(!active),
      items,
      hash,
      transition,
      alwaysOpen,
      isActive
    };
  }, [accordionRef, active, alwaysOpen, hash, isActive, items, transition]);
  return import_react.default.createElement(AccordionItemContext.Provider, { value }, typeof children === "function" ? children({ open: active }) : children);
};
var AccordionHeader = ({ children, as = "button", className = "", href = "", onClick }) => {
  const { hash, toggle, items, alwaysOpen, isActive } = (0, import_react.useContext)(AccordionItemContext);
  const ref = (0, import_react.useRef)(null);
  const TagName = (0, import_react.useMemo)(() => {
    if (as) {
      return as;
    }
    return "button";
  }, [as]);
  (0, import_react.useEffect)(() => {
    if (isActive && ref && ref.current) {
      toggle();
      const button = ref.current;
      button.setAttribute("aria-expanded", "true");
      const content = document.querySelector(`#${button.getAttribute("aria-controls")}`);
      if (content) {
        content.style.maxHeight = "none";
      }
    }
  }, []);
  (0, import_react.useEffect)(() => {
    const toggleButton = (button) => {
      let ariaExpanded = button.getAttribute("aria-expanded");
      button.setAttribute("aria-expanded", ariaExpanded === "false" ? "true" : "false");
    };
    const toggleContent = (content) => {
      if (content) {
        const transitionEnd = () => {
          if (content.style.maxHeight !== "0px") {
            content.style.maxHeight = "none";
          }
          content.removeEventListener("transitionend", transitionEnd);
        };
        content.addEventListener("transitionend", transitionEnd);
        if (content.style.maxHeight === "0px") {
          content.style.maxHeight = content.scrollHeight + "px";
        } else {
          content.style.maxHeight = content.scrollHeight + "px";
          content.style.maxHeight = content.scrollHeight + "px";
          content.style.maxHeight = "0px";
        }
      }
    };
    if (ref && ref.current) {
      const button = ref == null ? void 0 : ref.current;
      const showAccordion = (e) => {
        var _a;
        if (TagName === "a") {
          e.preventDefault();
        }
        toggle();
        if (!alwaysOpen) {
          const buttons = (_a = button.parentNode) == null ? void 0 : _a.querySelectorAll(`:scope > ${TagName}[aria-expanded='true']`);
          if (buttons) {
            buttons.forEach((item) => {
              if (item && item !== button) {
                const id = item.id.split("-")[1];
                items[id](false);
                toggleButton(item);
                const content2 = document.querySelector(`#${item.getAttribute("aria-controls")}`);
                if (content2) {
                  toggleContent(content2);
                }
              }
            });
          }
        }
        toggleButton(button);
        const content = document.querySelector(`#${button.getAttribute("aria-controls")}`);
        toggleContent(content);
        if (onClick) {
          onClick(e);
        }
      };
      if (button) {
        button.addEventListener("click", showAccordion);
      }
      return () => {
        if (button) {
          button.removeEventListener("click", showAccordion);
        }
      };
    }
    return () => {
    };
  }, [TagName, alwaysOpen, items, onClick, toggle]);
  if (TagName === "a") {
    return import_react.default.createElement("a", { ref, id: `button-${hash}`, href, "aria-expanded": "false", className, "aria-controls": `content-${hash}` }, children);
  }
  return import_react.default.createElement(TagName, { ref, id: `button-${hash}`, "aria-expanded": "false", className, "aria-controls": `content-${hash}` }, children);
};
var AccordionBody = ({ children, as = "div", className = "" }) => {
  const { hash, transition } = (0, import_react.useContext)(AccordionItemContext);
  const TagName = (0, import_react.useMemo)(() => {
    if (as) {
      return as;
    }
    return "div";
  }, [as]);
  const transitionData = (0, import_react.useMemo)(() => {
    const defaultData = {
      duration: "300ms",
      timingFunction: "cubic-bezier(0, 0, 0.2, 1)"
    };
    if (transition && "duration" in transition && transition.duration) {
      defaultData.duration = transition.duration;
    }
    if (transition && "timingFunction" in transition && transition.timingFunction) {
      defaultData.timingFunction = transition.timingFunction;
    }
    return defaultData;
  }, [transition]);
  return import_react.default.createElement(TagName, { id: `content-${hash}`, "aria-labelledby": `button-${hash}`, className, style: {
    maxHeight: "0px",
    transitionProperty: "max-height",
    overflow: "hidden",
    transitionDuration: transitionData.duration,
    transitionTimingFunction: transitionData.timingFunction
  } }, children);
};
export {
  Accordion,
  AccordionBody,
  AccordionHeader,
  AccordionItem
};
//# sourceMappingURL=react-headless-accordion.js.map
